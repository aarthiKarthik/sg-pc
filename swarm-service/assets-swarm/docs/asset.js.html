<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: asset.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: asset.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/*******************************************************************************
*                   asset.js
*
* This file contains an Asset class, which is the way an asset is represented
* by OpsChain.  It consists of a list of hashes of its immediate children and
* an dictionary (object) of metadata key value pairs, both held in an
* asset property of an asset object  e.g.
*
*     myAsset.asset = [[1,2],{"data1":5,"data2":6}]
*
* The methods below are hopefully self-explanatory.
*
* version 0.0.1
*******************************************************************************/

'use strict';
const swarmhash = require('../src/swarm-hash.js');

/**
Class representing a single Asset (which would normally be combined with other
Assets in a hash-linked tree)
@class Asset
**/
class Asset{
  /**
  constructor for the asset class.
  @param {Array} a - array of hashes of any child assets
  @param {Object} d - list-like object, the properties of which are any data
  that is associated with the array
  The constructor adds a 16 byte nonce to the data - this ensures that each
  instance of an otherwise identical asset hashes to a difference value with
  high probability
  **/
  constructor(a,d){
    this.asset = [a,{...d}];
    //calculate the hash here and store the result - saves recalculating later
    this.hash = swarmhash(new Buffer(JSON.stringify(this.asset))).toString('hex');
  }
  /**
  returns the hash of the asset
  **/
  getHash(){
    return this.hash;
  }
  /**
  returns a string representation of the asset
  **/
  toString(){
    return JSON.stringify(this.asset);
  }
  /**
  adds a hash to the asset, representing one of its child assets
  @param {string} childHash - the hash of a child of the asset that needs adding
  **/
  addChildHash(childHash){
    var [a,d] = this.asset;
    return new Asset([...a, childHash],d);
  }
  /**
  adds a data property to the asset
  @param {string} key - the name of the data item
  @param {string} value - the value of the data item
  **/
  addData(key,value){
    var [a,d] = this.asset;
    var s = {};
    s[key] = value;
    return new Asset(a,{...d,...s});
  }
  /**
  returns and array containing child hashes read from the asset
  **/
  getChildHashes() {
    return this.asset[0];
  }
  /**
  returns a list-like object containing the data items of the asset
  **/
  getData() {
    return this.asset[1];
  }
}
module.exports = Asset;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Asset.html">Asset</a></li></ul><h3>Global</h3><ul><li><a href="global.html#appendAsset">appendAsset</a></li><li><a href="global.html#changeAsset">changeAsset</a></li><li><a href="global.html#createAssetTree">createAssetTree</a></li><li><a href="global.html#createFromJson">createFromJson</a></li><li><a href="global.html#db">db</a></li><li><a href="global.html#defaultRetriever">defaultRetriever</a></li><li><a href="global.html#defaultStorer">defaultStorer</a></li><li><a href="global.html#getAssetTree">getAssetTree</a></li><li><a href="global.html#getChildren">getChildren</a></li><li><a href="global.html#getFromHash">getFromHash</a></li><li><a href="global.html#getParent">getParent</a></li><li><a href="global.html#swarmHash">swarmHash</a></li><li><a href="global.html#swarmRetriever">swarmRetriever</a></li><li><a href="global.html#swarmStorer">swarmStorer</a></li><li><a href="global.html#traverseTree">traverseTree</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Dec 08 2017 12:54:56 GMT+0000 (GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
